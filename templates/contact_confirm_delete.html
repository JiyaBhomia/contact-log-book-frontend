<h2>Delete Contact</h2>
<p>Are you sure you want to delete this contact?</p>

<button id="delete-button">Confirm Delete</button>
<a href="{% url 'contact_list' %}">Cancel</a>

<script>
    const contactPK = "{{ contact_pk|default:'' }}";
    const token = localStorage.getItem('accessToken');
    const deleteBtn = document.getElementById('delete-button');

    document.addEventListener('DOMContentLoaded', () => {
        if (!token || !contactPK) {
            alert('Error: No token or contact ID found.');
            window.location.href = "{% url 'contact_list' %}";
        }
    });

    deleteBtn.addEventListener('click', async () => {
        try {
            const response = await fetch(`http://127.0.0.1:8001/api/contacts/${contactPK}/`, {
                method: 'DELETE',
                headers: {
                    'Authorization': `Bearer ${token}`
                }
            });

            if (response.status === 204) { // 204 No Content is success for DELETE
                window.location.href = "{% url 'contact_list' %}";
            } else if (response.status === 401) {
                window.location.href = "{% url 'login' %}";
            } else {
                alert('Failed to delete contact.');
            }
        } catch (error) {
            console.error('Error deleting contact:', error);
            alert('An error occurred.');
        }
    });
</script>